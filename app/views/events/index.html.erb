<%- column_div :type => :primary do -%>

<h2>Listing events</h2>
<% unless filter_by_day? -%>
<% special_days = @events.collect { |x| x.start_time.to_date }.uniq -%>
<%= 
  calendar(:year => @date.year, :month => @date.month, 
           :next_month_text => (link_to "Next Month", events_path(:month => @date.month+1, :year => @date.year)), 
           :previous_month_text => (link_to "Previous Month", events_path(:month => @date.month-1, :year => @date.year))) do |d|
    if special_days.include?(d)
      [link_to(d.mday, events_path(:year => d.year, :month => d.month, :day => d.mday)), { :class => "specialDay" }]
    else
      [d.mday]
    end
  end
%>
<% else -%>
  <ol class="list full">
    <%= render :partial => @events %>
  </ol>
<% end -%>

<% end -%>

<% column_div :type => :secondary do -%>
  <h2>Add new event</h2>
  <%= link_to "Click here", new_event_path %>
<% end -%>
